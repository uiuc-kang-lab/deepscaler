Here is the code without modifications to address other issues, such as efficiency: